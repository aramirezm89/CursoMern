{"ast":null,"code":"import _slicedToArray from\"C:\\\\Users\\\\metal\\\\OneDrive\\\\CursoMERN\\\\ProyectoCurso\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,createContext}from\"react\";import jwtDecode from\"jwt-decode\";import{getAccessTokenApi,getRefreshTokenApi,refreshAcessTokenApi,logout}from\"../api/auth\";export var AuthContext=createContext();export default function AuthProvider(props){var children=props.children;var _useState=useState({user:null,isLoading:true}),_useState2=_slicedToArray(_useState,2),user=_useState2[0],setUser=_useState2[1];useEffect(function(){checkUserLogin(setUser);},[]);return/*#__PURE__*/React.createElement(AuthContext.Provider,{value:user},children);}function checkUserLogin(setUser){var accessToken=getAccessTokenApi();if(!accessToken){var refreshToken=getRefreshTokenApi();if(!refreshToken){logout();setUser({user:null,isLoading:false});}else{refreshAcessTokenApi(refreshToken);}}else{setUser({isLoading:false,user:jwtDecode(accessToken)});}}","map":{"version":3,"sources":["C:/Users/metal/OneDrive/CursoMERN/ProyectoCurso/client/src/provider/AuthProvider.js"],"names":["React","useState","useEffect","createContext","jwtDecode","getAccessTokenApi","getRefreshTokenApi","refreshAcessTokenApi","logout","AuthContext","AuthProvider","props","children","user","isLoading","setUser","checkUserLogin","accessToken","refreshToken"],"mappings":"wLAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,CAAqCC,aAArC,KAA0D,OAA1D,CACA,MAAOC,CAAAA,SAAP,KAAsB,YAAtB,CACA,OACEC,iBADF,CAEEC,kBAFF,CAGEC,oBAHF,CAIEC,MAJF,KAKO,aALP,CAOA,MAAO,IAAMC,CAAAA,WAAW,CAAGN,aAAa,EAAjC,CAEP,cAAe,SAASO,CAAAA,YAAT,CAAsBC,KAAtB,CAA6B,IAClCC,CAAAA,QADkC,CACrBD,KADqB,CAClCC,QADkC,eAElBX,QAAQ,CAAC,CAC/BY,IAAI,CAAE,IADyB,CAE/BC,SAAS,CAAE,IAFoB,CAAD,CAFU,wCAEnCD,IAFmC,eAE7BE,OAF6B,eAO1Cb,SAAS,CAAC,UAAM,CACdc,cAAc,CAACD,OAAD,CAAd,CACD,CAFQ,CAEN,EAFM,CAAT,CAGA,mBAAO,oBAAC,WAAD,CAAa,QAAb,EAAsB,KAAK,CAAEF,IAA7B,EAAoCD,QAApC,CAAP,CACD,CAED,QAASI,CAAAA,cAAT,CAAwBD,OAAxB,CAAiC,CAC/B,GAAME,CAAAA,WAAW,CAAGZ,iBAAiB,EAArC,CAEA,GAAI,CAACY,WAAL,CAAkB,CAChB,GAAMC,CAAAA,YAAY,CAAGZ,kBAAkB,EAAvC,CACA,GAAI,CAACY,YAAL,CAAmB,CACjBV,MAAM,GACNO,OAAO,CAAC,CACNF,IAAI,CAAE,IADA,CAENC,SAAS,CAAE,KAFL,CAAD,CAAP,CAID,CAND,IAMO,CACLP,oBAAoB,CAACW,YAAD,CAApB,CACD,CACF,CAXD,IAWO,CACLH,OAAO,CAAC,CACND,SAAS,CAAE,KADL,CAEND,IAAI,CAAET,SAAS,CAACa,WAAD,CAFT,CAAD,CAAP,CAID,CACF","sourcesContent":["import React, { useState, useEffect, createContext } from \"react\";\r\nimport jwtDecode from \"jwt-decode\";\r\nimport {\r\n  getAccessTokenApi,\r\n  getRefreshTokenApi,\r\n  refreshAcessTokenApi,\r\n  logout,\r\n} from \"../api/auth\";\r\n\r\nexport const AuthContext = createContext();\r\n\r\nexport default function AuthProvider(props) {\r\n  const { children } = props;\r\n  const [user, setUser] = useState({\r\n    user: null,\r\n    isLoading: true,\r\n  });\r\n\r\n  useEffect(() => {\r\n    checkUserLogin(setUser);\r\n  }, []);\r\n  return <AuthContext.Provider value={user}>{children}</AuthContext.Provider>;\r\n}\r\n\r\nfunction checkUserLogin(setUser) {\r\n  const accessToken = getAccessTokenApi();\r\n\r\n  if (!accessToken) {\r\n    const refreshToken = getRefreshTokenApi();\r\n    if (!refreshToken) {\r\n      logout();\r\n      setUser({\r\n        user: null,\r\n        isLoading: false,\r\n      });\r\n    } else {\r\n      refreshAcessTokenApi(refreshToken);\r\n    }\r\n  } else {\r\n    setUser({\r\n      isLoading: false,\r\n      user: jwtDecode(accessToken),\r\n    });\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}