{"ast":null,"code":"import _slicedToArray from\"C:\\\\Users\\\\metal\\\\OneDrive\\\\CursoMERN\\\\ProyectoCurso\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{List,Button,Modal as ModalAntd,notification}from\"antd\";import{EditOutlined,DeleteOutlined}from\"@ant-design/icons\";import DragSortableList from\"react-drag-sortable\";import Modal from\"../../../../Modal\";import{getCourseDataUdemyApi,deleteCourseApi,updateCourseApi}from\"../../../../api/course\";import{getAccessTokenApi}from\"../../../../api/auth\";import AddEditCourseForm from\"../AddEditCourseForm\";import\"./CoursesList.scss\";var confirm=ModalAntd.confirm;export default function CoursesList(props){var courses=props.courses,setReloadCourses=props.setReloadCourses;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),listCourses=_useState2[0],setListCourses=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isVisibleModal=_useState4[0],setIsVisibleModal=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),modalTitle=_useState6[0],setModalTitle=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),modalContent=_useState8[0],setModalContent=_useState8[1];useEffect(function(){var listCoursesArray=[];courses.forEach(function(courses){listCoursesArray.push({content:/*#__PURE__*/React.createElement(Course,{courses:courses,deleteCourse:deleteCourse,editCourseModal:editCourseModal})});});setListCourses(listCoursesArray);},[courses]);var onSort=function onSort(sortedList,dropEvent){var accesToken=getAccessTokenApi();sortedList.forEach(function(item){var _id=item.content.props.courses._id;var order=item.rank;updateCourseApi(accesToken,_id,{order:order});});};var deleteCourse=function deleteCourse(courses){var accesToken=getAccessTokenApi();confirm({title:\"Eliminando Curso\",content:\"Estas seguro que quieres eliminar el curso \".concat(courses.idCourse),okText:\"Eliminar\",okType:\"danger\",cancelText:\"Cancelar\",onOk:function onOk(){deleteCourseApi(accesToken,courses._id).then(function(response){var typeNotification=response.code===200?\"success\":\"warning\";notification[typeNotification]({message:response.message});setReloadCourses(true);}).catch(function(){notification[\"error\"]({message:\"Error del servidor, intentalo más tarde.\"});});}});};var addCourseModal=function addCourseModal(){setIsVisibleModal(true);setModalTitle(\"Creando nuevo curso.\");setModalContent(/*#__PURE__*/React.createElement(AddEditCourseForm,{setIsVisibleModal:setIsVisibleModal,setReloadCourses:setReloadCourses}));};var editCourseModal=function editCourseModal(courses){setIsVisibleModal(true);setModalTitle(\"Actualizando curso.\");setModalContent(/*#__PURE__*/React.createElement(AddEditCourseForm,{setIsVisibleModal:setIsVisibleModal,setReloadCourses:setReloadCourses,courses:courses}));};return/*#__PURE__*/React.createElement(\"div\",{className:\"courses-list\"},/*#__PURE__*/React.createElement(\"div\",{className:\"courses-list-header\"},/*#__PURE__*/React.createElement(Button,{type:\"primary\",onClick:addCourseModal},\"Nuevo curso\")),/*#__PURE__*/React.createElement(\"div\",{className:\"courses-list-items\"},listCourses.length===0&&/*#__PURE__*/React.createElement(\"h2\",{style:{textAlign:\"center\",margin:0}},\"No tines cursos creados.\"),/*#__PURE__*/React.createElement(DragSortableList,{items:listCourses,onSort:onSort,type:\"vertical\"}),/*#__PURE__*/React.createElement(Modal,{title:modalTitle,isVisible:isVisibleModal,setIsVisible:setIsVisibleModal},modalContent)));}function Course(props){var courses=props.courses,deleteCourse=props.deleteCourse,editCourseModal=props.editCourseModal;var _useState9=useState(null),_useState10=_slicedToArray(_useState9,2),courseData=_useState10[0],setCourseData=_useState10[1];useEffect(function(){getCourseDataUdemyApi(courses.idCourse).then(function(response){if(response.code!==200){notification[\"warning\"]({message:\"EL curso con el id \".concat(courses.idCourse,\" no se ha encontrado.\")});}setCourseData(response.data);});},[courses]);if(!courseData){return null;}return/*#__PURE__*/React.createElement(List.Item,{actions:[/*#__PURE__*/React.createElement(Button,{type:\"primary\",onClick:function onClick(){return editCourseModal(courses);}},/*#__PURE__*/React.createElement(EditOutlined,null)),/*#__PURE__*/React.createElement(Button,{type:\"danger\",onClick:function onClick(){return deleteCourse(courses);}},/*#__PURE__*/React.createElement(DeleteOutlined,null))]},/*#__PURE__*/React.createElement(\"img\",{src:courseData.image_480x270,alt:courseData.title,style:{width:\"100px\",marginRight:\"20px\"}}),/*#__PURE__*/React.createElement(List.Item.Meta,{title:\"\".concat(courseData.title,\" | ID:\").concat(courses.idCourse),description:courseData.headline}));}","map":{"version":3,"sources":["C:/Users/metal/OneDrive/CursoMERN/ProyectoCurso/client/src/components/Admin/Courses/CoursesList/CoursesList.js"],"names":["React","useState","useEffect","List","Button","Modal","ModalAntd","notification","EditOutlined","DeleteOutlined","DragSortableList","getCourseDataUdemyApi","deleteCourseApi","updateCourseApi","getAccessTokenApi","AddEditCourseForm","confirm","CoursesList","props","courses","setReloadCourses","listCourses","setListCourses","isVisibleModal","setIsVisibleModal","modalTitle","setModalTitle","modalContent","setModalContent","listCoursesArray","forEach","push","content","deleteCourse","editCourseModal","onSort","sortedList","dropEvent","accesToken","item","_id","order","rank","title","idCourse","okText","okType","cancelText","onOk","then","response","typeNotification","code","message","catch","addCourseModal","length","textAlign","margin","Course","courseData","setCourseData","data","image_480x270","width","marginRight","headline"],"mappings":"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","sourcesContent":["import React,{useState,useEffect} from 'react';\r\nimport {List,Button,Modal as ModalAntd,notification} from \"antd\";\r\nimport {EditOutlined,DeleteOutlined} from \"@ant-design/icons\"\r\nimport DragSortableList from \"react-drag-sortable\";\r\nimport Modal from \"../../../../Modal\";\r\nimport {getCourseDataUdemyApi,deleteCourseApi, updateCourseApi} from \"../../../../api/course\"\r\nimport {getAccessTokenApi} from \"../../../../api/auth\";\r\nimport AddEditCourseForm from \"../AddEditCourseForm\"\r\n\r\nimport \"./CoursesList.scss\";\r\n\r\nconst {confirm} = ModalAntd;\r\n\r\nexport default function CoursesList(props) {\r\n    const {courses,setReloadCourses} = props;\r\n    const [listCourses, setListCourses] = useState([]);\r\n    const [isVisibleModal, setIsVisibleModal] = useState(false);\r\n    const [modalTitle, setModalTitle] = useState(\"\");\r\n    const [modalContent, setModalContent] = useState(null);\r\n   \r\n    \r\n    useEffect(() => {\r\n        const listCoursesArray = [];\r\n        courses.forEach(courses =>{\r\n            listCoursesArray.push({\r\n                content:(\r\n                    <Course courses={courses} deleteCourse={deleteCourse} editCourseModal={editCourseModal} />\r\n                )\r\n            });\r\n            \r\n        })\r\n        setListCourses(listCoursesArray);\r\n    }, [courses]);\r\n\r\n    \r\n    const onSort= (sortedList, dropEvent) =>{\r\n        const accesToken = getAccessTokenApi();\r\n        \r\n        sortedList.forEach(item =>{\r\n            const {_id} = item.content.props.courses;\r\n            const order = item.rank;\r\n            updateCourseApi(accesToken,_id,{order})\r\n            \r\n\r\n        })\r\n    }\r\n\r\n    const deleteCourse = courses =>{\r\n        \r\n        const accesToken = getAccessTokenApi();\r\n\r\n        confirm({\r\n            title:\"Eliminando Curso\",\r\n            content:`Estas seguro que quieres eliminar el curso ${courses.idCourse}`,\r\n            okText: \"Eliminar\",\r\n            okType:\"danger\",\r\n            cancelText:\"Cancelar\",\r\n            onOk(){\r\n                deleteCourseApi(accesToken,courses._id).then(response =>{\r\n                    const typeNotification = response.code === 200 ? \"success\" : \"warning\";\r\n                    notification[typeNotification]({\r\n                        message:response.message,\r\n                    });\r\n                    setReloadCourses(true);\r\n                }).catch(() =>{\r\n                    notification[\"error\"]({\r\n                        message: \"Error del servidor, intentalo más tarde.\"\r\n                    })\r\n                })\r\n            }\r\n        })\r\n    }\r\n\r\n    const  addCourseModal = () =>{\r\n        setIsVisibleModal(true);\r\n        setModalTitle(\"Creando nuevo curso.\");\r\n        setModalContent(\r\n            <AddEditCourseForm \r\n            setIsVisibleModal={setIsVisibleModal} \r\n            setReloadCourses={setReloadCourses}\r\n            />\r\n        )\r\n    }\r\n\r\n    const  editCourseModal =  courses =>{\r\n        setIsVisibleModal(true);\r\n        setModalTitle(\"Actualizando curso.\");\r\n        setModalContent(\r\n            <AddEditCourseForm \r\n            setIsVisibleModal={setIsVisibleModal} \r\n            setReloadCourses={setReloadCourses}\r\n            courses={courses}\r\n            />\r\n        )\r\n    }\r\n\r\n  \r\n    return (\r\n        <div className=\"courses-list\">\r\n            <div className=\"courses-list-header\">\r\n                <Button \r\n                type=\"primary\" \r\n                onClick={addCourseModal}\r\n                >\r\n                    Nuevo curso\r\n                </Button>\r\n            </div>\r\n\r\n            <div className=\"courses-list-items\">\r\n                {listCourses.length === 0 &&(\r\n                    <h2 style={{ textAlign:\"center\", margin:0}}>\r\n                        No tines cursos creados.\r\n                    </h2>\r\n                )}\r\n\r\n                <DragSortableList items={listCourses} onSort={onSort} type=\"vertical\"/>\r\n\r\n                <Modal\r\n                    title={modalTitle}\r\n                    isVisible = {isVisibleModal}\r\n                    setIsVisible = {setIsVisibleModal}\r\n                >\r\n                    {modalContent}\r\n                </Modal>\r\n            </div>\r\n        </div>\r\n        \r\n        \r\n    )\r\n}\r\n\r\nfunction Course(props){\r\n    const {courses, deleteCourse, editCourseModal} = props;\r\n    const [courseData, setCourseData] = useState(null);\r\n\r\n    useEffect(() => {\r\n      getCourseDataUdemyApi(courses.idCourse).then(response =>{\r\n          if(response.code !==200){\r\n              notification[\"warning\"]({\r\n                  message:`EL curso con el id ${courses.idCourse} no se ha encontrado.`\r\n              })\r\n          }\r\n\r\n          setCourseData(response.data);\r\n      })\r\n    }, [courses])\r\n\r\n    if(!courseData){\r\n        return null;\r\n    }\r\n  return(\r\n      <List.Item\r\n        actions={[\r\n            <Button \r\n             type=\"primary\"\r\n             onClick={() => editCourseModal(courses)}\r\n            >\r\n              <EditOutlined/>\r\n            </Button>,\r\n              <Button \r\n              type=\"danger\"\r\n              onClick={() =>deleteCourse(courses)}\r\n             >\r\n               <DeleteOutlined/>\r\n             </Button>\r\n\r\n        ]}\r\n      >\r\n          <img \r\n          src={courseData.image_480x270} \r\n          alt={courseData.title} \r\n          style={{width:\"100px\", marginRight:\"20px\"}}\r\n          />\r\n          <List.Item.Meta \r\n            title={`${courseData.title} | ID:${courses.idCourse}`}\r\n            description={courseData.headline}\r\n          />\r\n\r\n      </List.Item>\r\n  )\r\n}"]},"metadata":{},"sourceType":"module"}