{"ast":null,"code":"import _defineProperty from\"C:\\\\Users\\\\metal\\\\OneDrive\\\\CursoMERN\\\\ProyectoCurso\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";import _objectSpread from\"C:\\\\Users\\\\metal\\\\OneDrive\\\\CursoMERN\\\\ProyectoCurso\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"C:\\\\Users\\\\metal\\\\OneDrive\\\\CursoMERN\\\\ProyectoCurso\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState,useCallback,useEffect}from'react';import{Avatar,Form,Input,Select,Button,Row,Col,notification}from\"antd\";import{UserOutlined,MailOutlined,LockOutlined}from\"../../../../node_modules/@ant-design/icons\";import{updateUserApi,uploadAvatarApi,getAvatarApi}from\"../../../api/user\";import{getAccessTokenApi}from\"../../../api/auth\";import{useDropzone}from\"react-dropzone\";import{emailValidation,minLengthValidation}from\"../../../utils/formValidation\";import NoAvatar from\"../../../assets/images/png/9.1 no-avatar.png\";import\"./EditUserForm.scss\";export default function EditUserForm(props){var user=props.user,setIsVisibleModal=props.setIsVisibleModal,setReloadUsers=props.setReloadUsers;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),avatar=_useState2[0],setAvatar=_useState2[1];var _useState3=useState({}),_useState4=_slicedToArray(_useState3,2),userData=_useState4[0],setUserData=_useState4[1];useEffect(function(){setUserData({name:user.name,lastName:user.lastName,email:user.email,password:\"\",repeatPassword:\"\",role:user.role,avatar:user.avatar});},[user]);useEffect(function(){if(user.avatar){getAvatarApi(user.avatar).then(function(response){setAvatar(response);});}else{setAvatar(null);}},[user]);useEffect(function(){if(avatar){setUserData(_objectSpread({},userData,{avatar:avatar.file}));}},[avatar]);var updateUser=function updateUser(){var token=getAccessTokenApi();var userUpdate=userData;if(!userUpdate.name||!userUpdate.lastName||!userUpdate.email||!userUpdate.password||!userUpdate.repeatPassword){notification[\"error\"]({message:\"Todos los campos son obligatorios.\"});}else{if(userUpdate.password!==userUpdate.repeatPassword||userUpdate.password.length<6){notification[\"error\"]({message:\"Las contraseñas deben ser iguales o la contraseña es menor a 6 caracteres.\"});}else{delete userUpdate.repeatPassword;if(typeof userUpdate.avatar===\"object\"){uploadAvatarApi(token,userUpdate.avatar,user._id).then(function(response){userUpdate.avatar=response.avatarName;updateUserApi(token,userUpdate,user._id).then(function(result){notification[\"success\"]({message:result.message});});});setUserData({name:user.name,lastName:user.lastName,email:user.email,password:\"\",role:user.role,avatar:user.avatar});setIsVisibleModal(false);setReloadUsers(true);}else{updateUserApi(token,userUpdate,user._id).then(function(result){notification[\"success\"]({message:result.message});setUserData({name:user.name,lastName:user.lastName,email:user.email,password:\"\",role:user.role,avatar:user.avatar});setIsVisibleModal(false);setReloadUsers(true);});}}}};return/*#__PURE__*/React.createElement(\"div\",{className:\"edit-user-form\"},/*#__PURE__*/React.createElement(UploadAvatar,{avatar:avatar,setAvatar:setAvatar}),/*#__PURE__*/React.createElement(EditForm,{userData:userData,setUserData:setUserData,updateUser:updateUser}));}function UploadAvatar(props){var avatar=props.avatar,setAvatar=props.setAvatar;var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),avatarUrl=_useState6[0],setAvatarUrl=_useState6[1];useEffect(function(){if(avatar){if(avatar.preview){setAvatarUrl(avatar.preview);}else{setAvatarUrl(avatar);}}else{setAvatarUrl(null);}},[avatar]);var onDrop=useCallback(function(acceptedFiles){var file=acceptedFiles[0];setAvatar({file:file,preview:URL.createObjectURL(file)});},[setAvatar]);var _useDropzone=useDropzone({accept:\"image/jpeg, image/png\",noKeyBoard:true,onDrop:onDrop}),getRootProps=_useDropzone.getRootProps,getInputProps=_useDropzone.getInputProps,isDragActive=_useDropzone.isDragActive;return/*#__PURE__*/React.createElement(\"div\",Object.assign({className:\"upload-avatar\"},getRootProps()),/*#__PURE__*/React.createElement(\"input\",getInputProps()),isDragActive?/*#__PURE__*/React.createElement(Avatar,{size:150,src:NoAvatar}):/*#__PURE__*/React.createElement(Avatar,{size:150,src:avatar?avatarUrl:NoAvatar}));}function EditForm(props){var userData=props.userData,setUserData=props.setUserData,updateUser=props.updateUser;var Option=Select.Option;var changeForm=function changeForm(e){setUserData(_objectSpread({},userData,_defineProperty({},e.target.name,e.target.value)));};var _useState7=useState({email:false,password:false,repeatPassword:false}),_useState8=_slicedToArray(_useState7,2),formValid=_useState8[0],setFormValid=_useState8[1];var inputValidation=function inputValidation(e){var _e$target=e.target,type=_e$target.type,name=_e$target.name;if(type===\"email\"){setFormValid(_objectSpread({},formValid,_defineProperty({},name,emailValidation(e.target))));}if(type===\"password\"){setFormValid(_objectSpread({},formValid,_defineProperty({},name,minLengthValidation(e.target,6))));}if(type===\"checkbox\"){setFormValid(_objectSpread({},formValid,_defineProperty({},name,e.target.checked)));}};return/*#__PURE__*/React.createElement(Form,{className:\"form-edit\",onFinish:updateUser,onChange:changeForm},/*#__PURE__*/React.createElement(Row,{gutter:24},/*#__PURE__*/React.createElement(Col,{span:12},/*#__PURE__*/React.createElement(Form.Item,null,/*#__PURE__*/React.createElement(Input,{prefix:/*#__PURE__*/React.createElement(UserOutlined,null),name:\"name\",placeholder:\"Nombre\",value:userData.name,maxLength:50}))),/*#__PURE__*/React.createElement(Col,{span:12},/*#__PURE__*/React.createElement(Form.Item,null,/*#__PURE__*/React.createElement(Input,{prefix:/*#__PURE__*/React.createElement(UserOutlined,null),name:\"lastName\",placeholder:\"Apellido\",value:userData.lastName,maxLength:50})))),/*#__PURE__*/React.createElement(Row,{gutter:24},/*#__PURE__*/React.createElement(Col,{span:12},/*#__PURE__*/React.createElement(Form.Item,null,/*#__PURE__*/React.createElement(Input,{prefix:/*#__PURE__*/React.createElement(MailOutlined,null),name:\"email\",type:\"email\",placeholder:\"Correo\",value:userData.email,onChange:inputValidation,maxLength:100}))),/*#__PURE__*/React.createElement(Col,{span:12},/*#__PURE__*/React.createElement(Form.Item,null,/*#__PURE__*/React.createElement(Select,{placeholder:\"Selecciona un rol\",value:userData.role},/*#__PURE__*/React.createElement(Option,{value:\"admin\"},\"Administrador\"),/*#__PURE__*/React.createElement(Option,{value:\"editor\"},\"Editor\"),/*#__PURE__*/React.createElement(Option,{value:\"reviewer\"},\"Revisor\"))))),/*#__PURE__*/React.createElement(Row,{gutter:24},/*#__PURE__*/React.createElement(Col,{span:12},/*#__PURE__*/React.createElement(Form.Item,null,/*#__PURE__*/React.createElement(Input,{name:\"password\",prefix:/*#__PURE__*/React.createElement(LockOutlined,null),type:\"password\",value:userData.password,placeholder:\"Contrase\\xF1a\",onChange:inputValidation,maxLength:20}))),/*#__PURE__*/React.createElement(Col,{span:12},/*#__PURE__*/React.createElement(Form.Item,null,/*#__PURE__*/React.createElement(Input,{name:\"repeatPassword\",prefix:/*#__PURE__*/React.createElement(LockOutlined,null),type:\"password\",defaultValue:\"\",value:userData.repeatPassword,placeholder:\"Repita su Contrase\\xF1a\",onChange:inputValidation,maxLength:20})))),/*#__PURE__*/React.createElement(Form.Item,null,/*#__PURE__*/React.createElement(Button,{type:\"primary\",htmlType:\"submit\",className:\"btn-submit\"},\"Actualizar Usuario\")));}","map":{"version":3,"sources":["C:/Users/metal/OneDrive/CursoMERN/ProyectoCurso/client/src/components/Users/EditUserForm/EditUserForm.js"],"names":["React","useState","useCallback","useEffect","Avatar","Form","Input","Select","Button","Row","Col","notification","UserOutlined","MailOutlined","LockOutlined","updateUserApi","uploadAvatarApi","getAvatarApi","getAccessTokenApi","useDropzone","emailValidation","minLengthValidation","NoAvatar","EditUserForm","props","user","setIsVisibleModal","setReloadUsers","avatar","setAvatar","userData","setUserData","name","lastName","email","password","repeatPassword","role","then","response","file","updateUser","token","userUpdate","message","length","_id","avatarName","result","UploadAvatar","avatarUrl","setAvatarUrl","preview","onDrop","acceptedFiles","URL","createObjectURL","accept","noKeyBoard","getRootProps","getInputProps","isDragActive","EditForm","Option","changeForm","e","target","value","formValid","setFormValid","inputValidation","type","checked"],"mappings":"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","sourcesContent":["import React, {useState,useCallback,useEffect}from 'react'\r\nimport {Avatar,Form,Input,Select,Button,Row,Col, notification} from \"antd\"\r\nimport {UserOutlined,MailOutlined,LockOutlined} from \"../../../../node_modules/@ant-design/icons\"\r\nimport {updateUserApi,uploadAvatarApi,getAvatarApi} from \"../../../api/user\";\r\nimport {getAccessTokenApi} from \"../../../api/auth\";\r\nimport {useDropzone} from \"react-dropzone\";\r\nimport {\r\n    emailValidation,\r\n    minLengthValidation,\r\n  } from \"../../../utils/formValidation\";\r\n  \r\n\r\n\r\nimport NoAvatar from \"../../../assets/images/png/9.1 no-avatar.png\"\r\n\r\nimport \"./EditUserForm.scss\"\r\n\r\n\r\nexport default function EditUserForm(props){\r\n    const {user,setIsVisibleModal,setReloadUsers} = props;\r\n    const [avatar,setAvatar] = useState(null)\r\n    const [userData,setUserData] =  useState({})\r\n\r\n \r\n    useEffect(()=>{\r\n      setUserData({\r\n        name: user.name,\r\n        lastName : user.lastName,\r\n        email: user.email,\r\n        password: \"\",\r\n        repeatPassword:\"\",\r\n        role: user.role,\r\n        avatar: user.avatar\r\n\r\n      })\r\n    },[user])\r\n\r\n    useEffect(()=>{\r\n        if (user.avatar){\r\n            getAvatarApi(user.avatar).then(response =>{\r\n                setAvatar(response);\r\n            })\r\n        }else{\r\n            setAvatar(null);\r\n        }\r\n    },[user])\r\n\r\n\r\n\r\n    useEffect(() => {\r\n        if(avatar){\r\n            setUserData({\r\n                ...userData,\r\n                avatar : avatar.file\r\n            });\r\n        }\r\n    }, [avatar]);\r\n\r\n\r\n\r\n   \r\n     \r\n    const updateUser = () => {\r\n       \r\n        const token = getAccessTokenApi();\r\n        let userUpdate = userData;\r\n\r\n        if(!userUpdate.name || !userUpdate.lastName || !userUpdate.email || !userUpdate.password || !userUpdate.repeatPassword ){\r\n            notification[\"error\"]({\r\n                message: \"Todos los campos son obligatorios.\"\r\n            })\r\n           \r\n    }else{ \r\n         \r\n\r\n        if(userUpdate.password !== userUpdate.repeatPassword || userUpdate.password.length <6){\r\n            notification[\"error\"]({\r\n              message:  \"Las contraseñas deben ser iguales o la contraseña es menor a 6 caracteres.\"\r\n             \r\n            })\r\n           \r\n        } else{\r\n\r\n            delete userUpdate.repeatPassword;\r\n           \r\n            if( typeof  userUpdate.avatar ===\"object\"){\r\n                uploadAvatarApi(token,userUpdate.avatar, user._id).then(response =>{\r\n                    userUpdate.avatar = response.avatarName;\r\n                    updateUserApi(token,userUpdate,user._id).then( result =>{\r\n                        notification[\"success\"]({\r\n                            message: result.message\r\n                        });\r\n                    });\r\n                });\r\n                setUserData({\r\n                    name: user.name,\r\n                    lastName : user.lastName,\r\n                    email: user.email,\r\n                    password: \"\",\r\n                    role: user.role,\r\n                    avatar: user.avatar\r\n                  \r\n                   })\r\n                   setIsVisibleModal(false)\r\n                   setReloadUsers(true)\r\n            }else{\r\n                \r\n                updateUserApi(token,userUpdate,user._id).then(result =>{\r\n                    notification[\"success\" ]({\r\n                        message: result.message\r\n                    });\r\n                    setUserData({\r\n                        name: user.name,\r\n                        lastName : user.lastName,\r\n                        email: user.email,\r\n                        password: \"\",\r\n                        role: user.role,\r\n                        avatar: user.avatar\r\n                      \r\n                       })\r\n\r\n                       setIsVisibleModal(false)\r\n                       setReloadUsers(true)\r\n                });\r\n\r\n              \r\n            }\r\n\r\n     } }\r\n    }\r\n\r\n\r\n    return(\r\n        <div className=\"edit-user-form\">\r\n            <UploadAvatar avatar={avatar} setAvatar={setAvatar}/>\r\n             <EditForm userData={userData} setUserData={setUserData} updateUser={updateUser}  />\r\n        </div>\r\n    )\r\n}\r\n\r\nfunction UploadAvatar(props){\r\n    const {avatar,setAvatar} = props;\r\n    const [avatarUrl, setAvatarUrl] = useState(null);\r\n\r\n    useEffect(()=>{\r\n        if(avatar){\r\n            if(avatar.preview){\r\n                setAvatarUrl(avatar.preview)\r\n            }else{\r\n                setAvatarUrl(avatar)\r\n            }\r\n        }else{\r\n            setAvatarUrl(null)\r\n        }\r\n    },[avatar])\r\n\r\n    const onDrop = useCallback(\r\n        acceptedFiles => {\r\n            const file = acceptedFiles[0]\r\n            setAvatar({file,preview : URL.createObjectURL(file)});\r\n        },\r\n        [setAvatar]\r\n\r\n    );\r\n   \r\n    const {getRootProps, getInputProps, isDragActive} = useDropzone({\r\n        accept: \"image/jpeg, image/png\",\r\n        noKeyBoard: true,\r\n        onDrop\r\n \r\n    });\r\n\r\n    return(\r\n\r\n        <div className=\"upload-avatar\" {...getRootProps()}>\r\n            <input {...getInputProps()} />\r\n            {isDragActive ? (\r\n                <Avatar size={150} src={NoAvatar} />\r\n            ):(\r\n                <Avatar size={150} src={avatar ? avatarUrl : NoAvatar} />\r\n            )}\r\n        </div>\r\n    )\r\n\r\n}\r\n\r\nfunction EditForm(props){\r\n    const{ userData, setUserData, updateUser} = props\r\n    const {Option} = Select;\r\n\r\n\r\n    const changeForm = (e) => {\r\n       \r\n        setUserData({\r\n          ...userData,\r\n          [e.target.name]: e.target.value,\r\n        });\r\n      \r\n    };\r\n\r\n\r\n    const [formValid, setFormValid] = useState({\r\n        email: false,\r\n        password: false,\r\n        repeatPassword: false,\r\n      });\r\n    \r\n     \r\n\r\n    const inputValidation = (e) => {\r\n        const { type, name } = e.target;\r\n      \r\n        if (type === \"email\") {\r\n          setFormValid({\r\n            ...formValid,\r\n            [name]: emailValidation(e.target),\r\n          });\r\n          \r\n        }\r\n    \r\n        if (type === \"password\") {\r\n          setFormValid({\r\n            ...formValid,\r\n            [name]: minLengthValidation(e.target, 6),\r\n          });\r\n        }\r\n    \r\n        if (type === \"checkbox\") {\r\n          setFormValid({\r\n            ...formValid,\r\n            [name]: e.target.checked,\r\n          });\r\n        }\r\n      };\r\n\r\n    return(\r\n       <Form className=\"form-edit\"\r\n             onFinish={updateUser}\r\n             onChange={changeForm}\r\n       >\r\n        <Row gutter={24}>\r\n            <Col span={12}> \r\n              <Form.Item>\r\n                 <Input prefix={<UserOutlined/>}\r\n                 name= \"name\"\r\n                  placeholder=\"Nombre\"\r\n                  value={userData.name}\r\n                  maxLength={50}\r\n                  />\r\n               \r\n              </Form.Item>\r\n            </Col>\r\n            <Col span={12}> \r\n                <Form.Item>\r\n                    <Input prefix={<UserOutlined/>}\r\n                        name = \"lastName\"\r\n                        placeholder=\"Apellido\"\r\n                        value={userData.lastName}\r\n                       maxLength={50}\r\n                    />\r\n                </Form.Item>\r\n            \r\n             </Col>\r\n        </Row>\r\n\r\n        <Row gutter={24}>\r\n            <Col span={12}> \r\n                <Form.Item>\r\n                    <Input prefix={<MailOutlined/>}\r\n                        name = \"email\"\r\n                        type=\"email\"\r\n                        placeholder=\"Correo\"\r\n                        value={userData.email}\r\n                        onChange={inputValidation}\r\n                        maxLength={100}\r\n                       \r\n                    />\r\n                </Form.Item>\r\n           \r\n            </Col>\r\n            <Col span={12}>  \r\n                <Form.Item>\r\n                      <Select\r\n                           placeholder=\"Selecciona un rol\"\r\n                            value={userData.role}\r\n            \r\n                        >\r\n                            <Option value= \"admin\">Administrador</Option>\r\n                            <Option value = \"editor\">Editor</Option>\r\n                            <Option value = \"reviewer\">Revisor</Option>\r\n\r\n                        </Select>\r\n                </Form.Item>\r\n           \r\n            </Col>\r\n        </Row>\r\n\r\n        <Row gutter={24}>\r\n            <Col span={12}>\r\n                <Form.Item>\r\n                    <Input\r\n                        name= \"password\"\r\n                        prefix={<LockOutlined/>}\r\n                        type=\"password\"\r\n                        value={userData.password}\r\n                        placeholder=\"Contraseña\"\r\n                        onChange={inputValidation}\r\n                        maxLength={20}\r\n                      \r\n                    />\r\n                </Form.Item>\r\n                \r\n             </Col>\r\n\r\n            <Col span={12}> \r\n            \r\n            <Form.Item>\r\n                    <Input\r\n                       name=\"repeatPassword\"\r\n                        prefix={<LockOutlined/>}\r\n                        type=\"password\"\r\n                        defaultValue=\"\"\r\n                        value={userData.repeatPassword}\r\n                        placeholder=\"Repita su Contraseña\"\r\n                        onChange={inputValidation}\r\n                        maxLength={20}\r\n                    />\r\n                </Form.Item>\r\n             </Col>\r\n        </Row>\r\n\r\n        <Form.Item>\r\n            <Button type=\"primary\" htmlType=\"submit\" className=\"btn-submit\">\r\n                Actualizar Usuario\r\n            </Button>\r\n        </Form.Item>\r\n       </Form>\r\n    )\r\n}"]},"metadata":{},"sourceType":"module"}